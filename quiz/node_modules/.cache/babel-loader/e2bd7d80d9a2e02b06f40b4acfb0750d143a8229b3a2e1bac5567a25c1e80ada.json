{"ast":null,"code":"// Real Supabase Database Service\nimport { createSupabaseClientFromEnv, SUPABASE_CONFIG } from '../../../auth/src';\nclass DatabaseService {\n  constructor() {\n    this.supabase = null;\n    this.tables = SUPABASE_CONFIG.tables;\n    this.initializeSupabase();\n  }\n\n  // 初始化Supabase客户端\n  initializeSupabase() {\n    try {\n      this.supabase = createSupabaseClientFromEnv();\n      console.log('✅ DatabaseService: Supabase client initialized');\n    } catch (error) {\n      console.error('❌ DatabaseService: Failed to initialize Supabase client:', error);\n      throw error;\n    }\n  }\n\n  // ===============================\n  // 题目相关操作\n  // ===============================\n\n  async addQuestion(questionData) {\n    try {\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.questions).insert([{\n        title: questionData.title,\n        content: questionData.content,\n        type: questionData.type || 'multiple_choice',\n        options: questionData.options,\n        correct_answer: questionData.correctAnswer,\n        explanation: questionData.explanation,\n        difficulty: questionData.difficulty || 1,\n        is_active: true\n      }]).select().single();\n      if (error) throw error;\n\n      // 如果有标签，添加标签关联\n      if (questionData.tags && questionData.tags.length > 0) {\n        await this.addQuestionTags(data.id, questionData.tags);\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error adding question:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async getQuestions(filters = {}) {\n    try {\n      let query = this.supabase.from(this.tables.questions).select(`\n          *,\n          question_tags (\n            tags (\n              id,\n              name,\n              color\n            )\n          )\n        `).eq('is_active', true).order('created_at', {\n        ascending: false\n      });\n\n      // 应用过滤器\n      if (filters.difficulty) {\n        query = query.eq('difficulty', filters.difficulty);\n      }\n      if (filters.type) {\n        query = query.eq('type', filters.type);\n      }\n      if (filters.search) {\n        query = query.or(`title.ilike.%${filters.search}%,content.ilike.%${filters.search}%`);\n      }\n      const {\n        data,\n        error\n      } = await query;\n      if (error) throw error;\n\n      // 格式化数据，将标签扁平化\n      const formattedData = data.map(question => {\n        var _question$question_ta;\n        return {\n          ...question,\n          tags: ((_question$question_ta = question.question_tags) === null || _question$question_ta === void 0 ? void 0 : _question$question_ta.map(qt => qt.tags)) || []\n        };\n      });\n      return {\n        success: true,\n        data: formattedData\n      };\n    } catch (error) {\n      console.error('Error getting questions:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async getQuestionById(id) {\n    try {\n      var _data$question_tags;\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.questions).select(`\n          *,\n          question_tags (\n            tags (\n              id,\n              name,\n              color\n            )\n          )\n        `).eq('id', id).eq('is_active', true).single();\n      if (error) throw error;\n\n      // 格式化标签\n      const formattedData = {\n        ...data,\n        tags: ((_data$question_tags = data.question_tags) === null || _data$question_tags === void 0 ? void 0 : _data$question_tags.map(qt => qt.tags)) || []\n      };\n      return {\n        success: true,\n        data: formattedData\n      };\n    } catch (error) {\n      console.error('Error getting question:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async updateQuestion(id, updates) {\n    try {\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.questions).update({\n        ...updates,\n        updated_at: new Date().toISOString()\n      }).eq('id', id).select().single();\n      if (error) throw error;\n\n      // 如果更新了标签，重新设置标签关联\n      if (updates.tags !== undefined) {\n        await this.updateQuestionTags(id, updates.tags);\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error updating question:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async deleteQuestion(id) {\n    try {\n      const {\n        error\n      } = await this.supabase.from(this.tables.questions).update({\n        is_active: false\n      }) // 软删除\n      .eq('id', id);\n      if (error) throw error;\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Error deleting question:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ===============================\n  // 标签相关操作\n  // ===============================\n\n  async getTags() {\n    try {\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.tags).select('*').order('name');\n      if (error) throw error;\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error getting tags:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async addTag(tagData) {\n    try {\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.tags).insert([{\n        name: tagData.name,\n        color: tagData.color || '#3B82F6',\n        description: tagData.description\n      }]).select().single();\n      if (error) throw error;\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error adding tag:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async addQuestionTags(questionId, tagIds) {\n    try {\n      const tagAssociations = tagIds.map(tagId => ({\n        question_id: questionId,\n        tag_id: tagId\n      }));\n      const {\n        error\n      } = await this.supabase.from(this.tables.question_tags).insert(tagAssociations);\n      if (error) throw error;\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Error adding question tags:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async updateQuestionTags(questionId, tagIds) {\n    try {\n      // 先删除现有关联\n      await this.supabase.from(this.tables.question_tags).delete().eq('question_id', questionId);\n\n      // 如果有新标签，添加新关联\n      if (tagIds && tagIds.length > 0) {\n        await this.addQuestionTags(questionId, tagIds);\n      }\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Error updating question tags:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ===============================\n  // 答题记录相关操作\n  // ===============================\n\n  async recordAttempt(attemptData) {\n    try {\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.attempts).insert([{\n        question_id: attemptData.questionId,\n        user_answer: attemptData.userAnswer,\n        is_correct: attemptData.isCorrect,\n        response_time: attemptData.responseTime,\n        user_id: attemptData.userId,\n        session_id: attemptData.sessionId\n      }]).select().single();\n      if (error) throw error;\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error recording attempt:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n  async getAttempts(filters = {}) {\n    try {\n      let query = this.supabase.from(this.tables.attempts).select(`\n          *,\n          questions (\n            id,\n            title,\n            difficulty\n          )\n        `).order('attempted_at', {\n        ascending: false\n      });\n      if (filters.userId) {\n        query = query.eq('user_id', filters.userId);\n      }\n      if (filters.sessionId) {\n        query = query.eq('session_id', filters.sessionId);\n      }\n      if (filters.questionId) {\n        query = query.eq('question_id', filters.questionId);\n      }\n      const {\n        data,\n        error\n      } = await query;\n      if (error) throw error;\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error('Error getting attempts:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ===============================\n  // 统计相关操作\n  // ===============================\n\n  async getStatistics(userId = null, sessionId = null) {\n    try {\n      let filter = {};\n      if (userId) filter.user_id = userId;\n      if (sessionId) filter.session_id = sessionId;\n      const {\n        data: attempts,\n        error\n      } = await this.supabase.from(this.tables.attempts).select('*').match(filter);\n      if (error) throw error;\n      const stats = {\n        totalQuestions: attempts.length,\n        correctAnswers: attempts.filter(a => a.is_correct).length,\n        averageTime: attempts.length > 0 ? attempts.reduce((sum, a) => sum + (a.response_time || 0), 0) / attempts.length : 0,\n        accuracy: attempts.length > 0 ? attempts.filter(a => a.is_correct).length / attempts.length * 100 : 0\n      };\n      return {\n        success: true,\n        data: stats\n      };\n    } catch (error) {\n      console.error('Error getting statistics:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n\n  // ===============================\n  // 工具方法\n  // ===============================\n\n  async testConnection() {\n    try {\n      if (!this.supabase) {\n        throw new Error('Supabase client not initialized');\n      }\n      const {\n        data,\n        error\n      } = await this.supabase.from(this.tables.questions).select('count(*)').limit(1);\n      if (error) throw error;\n      console.log('✅ Supabase connection successful!');\n      return {\n        success: true,\n        message: 'Database connection successful'\n      };\n    } catch (error) {\n      console.error('❌ Supabase connection failed:', error);\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  }\n}\n\n// 导出单例实例\nexport default new DatabaseService();","map":{"version":3,"names":["createSupabaseClientFromEnv","SUPABASE_CONFIG","DatabaseService","constructor","supabase","tables","initializeSupabase","console","log","error","addQuestion","questionData","data","from","questions","insert","title","content","type","options","correct_answer","correctAnswer","explanation","difficulty","is_active","select","single","tags","length","addQuestionTags","id","success","message","getQuestions","filters","query","eq","order","ascending","search","or","formattedData","map","question","_question$question_ta","question_tags","qt","getQuestionById","_data$question_tags","updateQuestion","updates","update","updated_at","Date","toISOString","undefined","updateQuestionTags","deleteQuestion","getTags","addTag","tagData","name","color","description","questionId","tagIds","tagAssociations","tagId","question_id","tag_id","delete","recordAttempt","attemptData","attempts","user_answer","userAnswer","is_correct","isCorrect","response_time","responseTime","user_id","userId","session_id","sessionId","getAttempts","getStatistics","filter","match","stats","totalQuestions","correctAnswers","a","averageTime","reduce","sum","accuracy","testConnection","Error","limit"],"sources":["/Users/damonxu/Documents/GitHub/my-projects/quiz/src/services/DatabaseService.js"],"sourcesContent":["// Real Supabase Database Service\nimport { createSupabaseClientFromEnv, SUPABASE_CONFIG } from '../../../auth/src';\n\nclass DatabaseService {\n  constructor() {\n    this.supabase = null;\n    this.tables = SUPABASE_CONFIG.tables;\n    this.initializeSupabase();\n  }\n\n  // 初始化Supabase客户端\n  initializeSupabase() {\n    try {\n      this.supabase = createSupabaseClientFromEnv();\n      console.log('✅ DatabaseService: Supabase client initialized');\n    } catch (error) {\n      console.error('❌ DatabaseService: Failed to initialize Supabase client:', error);\n      throw error;\n    }\n  }\n\n  // ===============================\n  // 题目相关操作\n  // ===============================\n  \n  async addQuestion(questionData) {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.questions)\n        .insert([{\n          title: questionData.title,\n          content: questionData.content,\n          type: questionData.type || 'multiple_choice',\n          options: questionData.options,\n          correct_answer: questionData.correctAnswer,\n          explanation: questionData.explanation,\n          difficulty: questionData.difficulty || 1,\n          is_active: true\n        }])\n        .select()\n        .single();\n\n      if (error) throw error;\n      \n      // 如果有标签，添加标签关联\n      if (questionData.tags && questionData.tags.length > 0) {\n        await this.addQuestionTags(data.id, questionData.tags);\n      }\n\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error adding question:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async getQuestions(filters = {}) {\n    try {\n      let query = this.supabase\n        .from(this.tables.questions)\n        .select(`\n          *,\n          question_tags (\n            tags (\n              id,\n              name,\n              color\n            )\n          )\n        `)\n        .eq('is_active', true)\n        .order('created_at', { ascending: false });\n\n      // 应用过滤器\n      if (filters.difficulty) {\n        query = query.eq('difficulty', filters.difficulty);\n      }\n      \n      if (filters.type) {\n        query = query.eq('type', filters.type);\n      }\n\n      if (filters.search) {\n        query = query.or(`title.ilike.%${filters.search}%,content.ilike.%${filters.search}%`);\n      }\n\n      const { data, error } = await query;\n      \n      if (error) throw error;\n\n      // 格式化数据，将标签扁平化\n      const formattedData = data.map(question => ({\n        ...question,\n        tags: question.question_tags?.map(qt => qt.tags) || []\n      }));\n\n      return { success: true, data: formattedData };\n    } catch (error) {\n      console.error('Error getting questions:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async getQuestionById(id) {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.questions)\n        .select(`\n          *,\n          question_tags (\n            tags (\n              id,\n              name,\n              color\n            )\n          )\n        `)\n        .eq('id', id)\n        .eq('is_active', true)\n        .single();\n\n      if (error) throw error;\n\n      // 格式化标签\n      const formattedData = {\n        ...data,\n        tags: data.question_tags?.map(qt => qt.tags) || []\n      };\n\n      return { success: true, data: formattedData };\n    } catch (error) {\n      console.error('Error getting question:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async updateQuestion(id, updates) {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.questions)\n        .update({\n          ...updates,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      // 如果更新了标签，重新设置标签关联\n      if (updates.tags !== undefined) {\n        await this.updateQuestionTags(id, updates.tags);\n      }\n\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error updating question:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async deleteQuestion(id) {\n    try {\n      const { error } = await this.supabase\n        .from(this.tables.questions)\n        .update({ is_active: false })  // 软删除\n        .eq('id', id);\n\n      if (error) throw error;\n      return { success: true };\n    } catch (error) {\n      console.error('Error deleting question:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  // ===============================\n  // 标签相关操作\n  // ===============================\n\n  async getTags() {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.tags)\n        .select('*')\n        .order('name');\n\n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error getting tags:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async addTag(tagData) {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.tags)\n        .insert([{\n          name: tagData.name,\n          color: tagData.color || '#3B82F6',\n          description: tagData.description\n        }])\n        .select()\n        .single();\n\n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error adding tag:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async addQuestionTags(questionId, tagIds) {\n    try {\n      const tagAssociations = tagIds.map(tagId => ({\n        question_id: questionId,\n        tag_id: tagId\n      }));\n\n      const { error } = await this.supabase\n        .from(this.tables.question_tags)\n        .insert(tagAssociations);\n\n      if (error) throw error;\n      return { success: true };\n    } catch (error) {\n      console.error('Error adding question tags:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async updateQuestionTags(questionId, tagIds) {\n    try {\n      // 先删除现有关联\n      await this.supabase\n        .from(this.tables.question_tags)\n        .delete()\n        .eq('question_id', questionId);\n\n      // 如果有新标签，添加新关联\n      if (tagIds && tagIds.length > 0) {\n        await this.addQuestionTags(questionId, tagIds);\n      }\n\n      return { success: true };\n    } catch (error) {\n      console.error('Error updating question tags:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  // ===============================\n  // 答题记录相关操作\n  // ===============================\n\n  async recordAttempt(attemptData) {\n    try {\n      const { data, error } = await this.supabase\n        .from(this.tables.attempts)\n        .insert([{\n          question_id: attemptData.questionId,\n          user_answer: attemptData.userAnswer,\n          is_correct: attemptData.isCorrect,\n          response_time: attemptData.responseTime,\n          user_id: attemptData.userId,\n          session_id: attemptData.sessionId\n        }])\n        .select()\n        .single();\n\n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error recording attempt:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  async getAttempts(filters = {}) {\n    try {\n      let query = this.supabase\n        .from(this.tables.attempts)\n        .select(`\n          *,\n          questions (\n            id,\n            title,\n            difficulty\n          )\n        `)\n        .order('attempted_at', { ascending: false });\n\n      if (filters.userId) {\n        query = query.eq('user_id', filters.userId);\n      }\n\n      if (filters.sessionId) {\n        query = query.eq('session_id', filters.sessionId);\n      }\n\n      if (filters.questionId) {\n        query = query.eq('question_id', filters.questionId);\n      }\n\n      const { data, error } = await query;\n      \n      if (error) throw error;\n      return { success: true, data };\n    } catch (error) {\n      console.error('Error getting attempts:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  // ===============================\n  // 统计相关操作\n  // ===============================\n\n  async getStatistics(userId = null, sessionId = null) {\n    try {\n      let filter = {};\n      if (userId) filter.user_id = userId;\n      if (sessionId) filter.session_id = sessionId;\n\n      const { data: attempts, error } = await this.supabase\n        .from(this.tables.attempts)\n        .select('*')\n        .match(filter);\n\n      if (error) throw error;\n\n      const stats = {\n        totalQuestions: attempts.length,\n        correctAnswers: attempts.filter(a => a.is_correct).length,\n        averageTime: attempts.length > 0 ? \n          attempts.reduce((sum, a) => sum + (a.response_time || 0), 0) / attempts.length : 0,\n        accuracy: attempts.length > 0 ? \n          (attempts.filter(a => a.is_correct).length / attempts.length) * 100 : 0\n      };\n\n      return { success: true, data: stats };\n    } catch (error) {\n      console.error('Error getting statistics:', error);\n      return { success: false, error: error.message };\n    }\n  }\n\n  // ===============================\n  // 工具方法\n  // ===============================\n\n  async testConnection() {\n    try {\n      if (!this.supabase) {\n        throw new Error('Supabase client not initialized');\n      }\n\n      const { data, error } = await this.supabase\n        .from(this.tables.questions)\n        .select('count(*)')\n        .limit(1);\n\n      if (error) throw error;\n      \n      console.log('✅ Supabase connection successful!');\n      return { success: true, message: 'Database connection successful' };\n    } catch (error) {\n      console.error('❌ Supabase connection failed:', error);\n      return { success: false, error: error.message };\n    }\n  }\n}\n\n// 导出单例实例\nexport default new DatabaseService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}