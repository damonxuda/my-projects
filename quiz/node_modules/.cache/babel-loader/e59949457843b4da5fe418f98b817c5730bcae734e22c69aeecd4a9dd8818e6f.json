{"ast":null,"code":"// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\nexport default class Serializer{constructor(){this.HEADER_LENGTH=1;}decode(rawPayload,callback){if(rawPayload.constructor===ArrayBuffer){return callback(this._binaryDecode(rawPayload));}if(typeof rawPayload==='string'){return callback(JSON.parse(rawPayload));}return callback({});}_binaryDecode(buffer){const view=new DataView(buffer);const decoder=new TextDecoder();return this._decodeBroadcast(buffer,view,decoder);}_decodeBroadcast(buffer,view,decoder){const topicSize=view.getUint8(1);const eventSize=view.getUint8(2);let offset=this.HEADER_LENGTH+2;const topic=decoder.decode(buffer.slice(offset,offset+topicSize));offset=offset+topicSize;const event=decoder.decode(buffer.slice(offset,offset+eventSize));offset=offset+eventSize;const data=JSON.parse(decoder.decode(buffer.slice(offset,buffer.byteLength)));return{ref:null,topic:topic,event:event,payload:data};}}","map":{"version":3,"names":["Serializer","constructor","HEADER_LENGTH","decode","rawPayload","callback","ArrayBuffer","_binaryDecode","JSON","parse","buffer","view","DataView","decoder","TextDecoder","_decodeBroadcast","topicSize","getUint8","eventSize","offset","topic","slice","event","data","byteLength","ref","payload"],"sources":["/Users/damonxu/Documents/GitHub/my-projects/auth/node_modules/@supabase/realtime-js/src/lib/serializer.ts"],"sourcesContent":["// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\n\nexport default class Serializer {\n  HEADER_LENGTH = 1\n\n  decode(rawPayload: ArrayBuffer | string, callback: Function) {\n    if (rawPayload.constructor === ArrayBuffer) {\n      return callback(this._binaryDecode(rawPayload))\n    }\n\n    if (typeof rawPayload === 'string') {\n      return callback(JSON.parse(rawPayload))\n    }\n\n    return callback({})\n  }\n\n  private _binaryDecode(buffer: ArrayBuffer) {\n    const view = new DataView(buffer)\n    const decoder = new TextDecoder()\n\n    return this._decodeBroadcast(buffer, view, decoder)\n  }\n\n  private _decodeBroadcast(\n    buffer: ArrayBuffer,\n    view: DataView,\n    decoder: TextDecoder\n  ): {\n    ref: null\n    topic: string\n    event: string\n    payload: { [key: string]: any }\n  } {\n    const topicSize = view.getUint8(1)\n    const eventSize = view.getUint8(2)\n    let offset = this.HEADER_LENGTH + 2\n    const topic = decoder.decode(buffer.slice(offset, offset + topicSize))\n    offset = offset + topicSize\n    const event = decoder.decode(buffer.slice(offset, offset + eventSize))\n    offset = offset + eventSize\n    const data = JSON.parse(\n      decoder.decode(buffer.slice(offset, buffer.byteLength))\n    )\n\n    return { ref: null, topic: topic, event: event, payload: data }\n  }\n}\n"],"mappings":"AAAA;AACA;AAEA,cAAc,MAAO,CAAAA,UAAU,CAA/BC,YAAA,EACE,KAAAC,aAAa,CAAG,CAAC,CA4CnB,CA1CEC,MAAMA,CAACC,UAAgC,CAAEC,QAAkB,EACzD,GAAID,UAAU,CAACH,WAAW,GAAKK,WAAW,CAAE,CAC1C,MAAO,CAAAD,QAAQ,CAAC,IAAI,CAACE,aAAa,CAACH,UAAU,CAAC,CAAC,CACjD,CAEA,GAAI,MAAO,CAAAA,UAAU,GAAK,QAAQ,CAAE,CAClC,MAAO,CAAAC,QAAQ,CAACG,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC,CAAC,CACzC,CAEA,MAAO,CAAAC,QAAQ,CAAC,EAAE,CAAC,CACrB,CAEQE,aAAaA,CAACG,MAAmB,EACvC,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAACF,MAAM,CAAC,CACjC,KAAM,CAAAG,OAAO,CAAG,GAAI,CAAAC,WAAW,EAAE,CAEjC,MAAO,KAAI,CAACC,gBAAgB,CAACL,MAAM,CAAEC,IAAI,CAAEE,OAAO,CAAC,CACrD,CAEQE,gBAAgBA,CACtBL,MAAmB,CACnBC,IAAc,CACdE,OAAoB,EAOpB,KAAM,CAAAG,SAAS,CAAGL,IAAI,CAACM,QAAQ,CAAC,CAAC,CAAC,CAClC,KAAM,CAAAC,SAAS,CAAGP,IAAI,CAACM,QAAQ,CAAC,CAAC,CAAC,CAClC,GAAI,CAAAE,MAAM,CAAG,IAAI,CAACjB,aAAa,CAAG,CAAC,CACnC,KAAM,CAAAkB,KAAK,CAAGP,OAAO,CAACV,MAAM,CAACO,MAAM,CAACW,KAAK,CAACF,MAAM,CAAEA,MAAM,CAAGH,SAAS,CAAC,CAAC,CACtEG,MAAM,CAAGA,MAAM,CAAGH,SAAS,CAC3B,KAAM,CAAAM,KAAK,CAAGT,OAAO,CAACV,MAAM,CAACO,MAAM,CAACW,KAAK,CAACF,MAAM,CAAEA,MAAM,CAAGD,SAAS,CAAC,CAAC,CACtEC,MAAM,CAAGA,MAAM,CAAGD,SAAS,CAC3B,KAAM,CAAAK,IAAI,CAAGf,IAAI,CAACC,KAAK,CACrBI,OAAO,CAACV,MAAM,CAACO,MAAM,CAACW,KAAK,CAACF,MAAM,CAAET,MAAM,CAACc,UAAU,CAAC,CAAC,CACxD,CAED,MAAO,CAAEC,GAAG,CAAE,IAAI,CAAEL,KAAK,CAAEA,KAAK,CAAEE,KAAK,CAAEA,KAAK,CAAEI,OAAO,CAAEH,IAAI,CAAE,CACjE,C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}