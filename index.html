<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0" />

    <!-- ç¤¾äº¤åª’ä½“åˆ†äº«é¢„è§ˆ -->
    <meta property="og:title" content="å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’" />
    <meta property="og:description" content="2025å¹´æš‘å‡å­¦ä¹ è®¡åˆ’ï¼Œè¯¾ç¨‹å®‰æ’ä¸€ç›®äº†ç„¶ï¼Œæ”¯æŒåœ¨çº¿ç¼–è¾‘å’Œè¯¾ç¨‹æé†’" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=1200&h=630&fit=crop&auto=format" />
    <meta property="og:url" content="https://damonxuda.github.io/course-schedule/" />
    <meta property="og:type" content="website" />
    
    <!-- å¾®ä¿¡åˆ†äº«ä¼˜åŒ– -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’" />
    <meta name="twitter:description" content="2025å¹´æš‘å‡å­¦ä¹ è®¡åˆ’ï¼Œè¯¾ç¨‹å®‰æ’ä¸€ç›®äº†ç„¶ï¼Œæ”¯æŒåœ¨çº¿ç¼–è¾‘å’Œè¯¾ç¨‹æé†’" />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=1200&h=630&fit=crop&auto=format" />

    <!-- PWA æ”¯æŒ -->
    <meta name="theme-color" content="#667eea" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="è¯¾ç¨‹è¡¨" />
    <link
      rel="apple-touch-icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23667eea'/><text x='50' y='60' font-size='50' text-anchor='middle' fill='white'>ğŸ“š</text></svg>"
    />
    <link
      rel="manifest"
      href="data:application/json,{
        'name': 'æš‘å‡è¯¾ç¨‹æ—¥å†',
        'short_name': 'è¯¾ç¨‹è¡¨',
        'start_url': '.',
        'display': 'standalone',
        'background_color': '#667eea',
        'theme_color': '#667eea',
        'icons': [
            {
                'src': 'data:image/svg+xml,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 100 100\\'><rect width=\\'100\\' height=\\'100\\' fill=\\'%23667eea\\'/><text x=\\'50\\' y=\\'60\\' font-size=\\'50\\' text-anchor=\\'middle\\' fill=\\'white\\'>ğŸ“š</text></svg>',
                'sizes': '192x192',
                'type': 'image/svg+xml'
            }
        ]
    }"
    />
    <title>æš‘å‡è¯¾ç¨‹æ—¥å†æé†’</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Microsoft YaHei", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        touch-action: manipulation;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 1.8rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .current-date {
        font-size: 1.3rem;
        opacity: 0.9;
      }

      .main-content {
        padding: 30px;
      }

      .today-schedule {
        background: #f8f9ff;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 5px solid #667eea;
      }

      .schedule-title {
        font-size: 1.5rem;
        color: #333;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
      }

      .schedule-title::before {
        content: "ğŸ“…";
        margin-right: 10px;
        font-size: 1.8rem;
      }

      .course-item {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease;
      }

      .course-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .course-time {
        font-weight: bold;
        color: #ff6b6b;
        font-size: 1.1rem;
        margin-bottom: 5px;
      }

      .course-name {
        color: #333;
        font-size: 1rem;
      }

      .course-smk {
        background: #ffe066;
        border-left: 4px solid #ffd700;
      }

      .course-island {
        background: #66e0ff;
        border-left: 4px solid #00bcd4;
      }

      .course-teacher {
        background: #ff9999;
        border-left: 4px solid #f44336;
      }

      .course-english {
        background: #99ff99;
        border-left: 4px solid #4caf50;
      }

      .course-exercise {
        background: #90ee90;
        border-left: 4px solid #32cd32;
      }

      .course-homework {
        background: #ffb6c1;
        border-left: 4px solid #ff69b4;
      }

      .course-art {
        background: #ffb3e6;
        border-left: 4px solid #e91e63;
      }

      .course-other {
        background: #e0e0e0;
        border-left: 4px solid #757575;
      }

      .no-courses {
        text-align: center;
        color: #666;
        font-size: 1.2rem;
        padding: 40px;
      }

      .calendar-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .nav-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.3s ease;
        touch-action: manipulation;
        user-select: none;
      }

      .nav-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
      }

      .nav-btn:active {
        transform: translateY(0);
      }

      .date-display {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .stat-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        color: #666;
        margin-top: 5px;
      }

      .edit-toggle {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        margin-top: 20px;
        transition: all 0.3s ease;
        user-select: none;
      }

      .edit-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
      }

      /* ç¼–è¾‘å™¨æ ·å¼ */
      .editor-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1000;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .editor-panel {
        background: white;
        border-radius: 15px;
        padding: 30px;
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        position: relative;
      }

      .editor-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .editor-title {
        font-size: 1.4rem;
        font-weight: bold;
        color: #333;
      }

      .close-btn {
        background: #f0f0f0;
        border: none;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        cursor: pointer;
        font-size: 1.2rem;
        color: #666;
        transition: all 0.3s ease;
      }

      .close-btn:hover {
        background: #e0e0e0;
        transform: scale(1.1);
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #333;
        font-size: 0.9rem;
      }

      .form-input, .form-select, .form-textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s ease;
        box-sizing: border-box;
      }

      .form-input:focus, .form-select:focus, .form-textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-textarea {
        min-height: 80px;
        resize: vertical;
      }

      .time-inputs {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 10px;
        align-items: center;
      }

      .time-separator {
        text-align: center;
        font-weight: bold;
        color: #666;
      }

      .course-list {
        margin-bottom: 20px;
      }

      .course-item-edit {
        background: #f8f9ff;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-left: 4px solid #667eea;
      }

      .course-info {
        flex-grow: 1;
      }

      .course-time-edit {
        font-weight: bold;
        color: #ff6b6b;
        font-size: 0.9rem;
      }

      .course-name-edit {
        color: #333;
        font-size: 0.95rem;
        margin-top: 2px;
      }

      .course-actions {
        display: flex;
        gap: 8px;
      }

      .btn-small {
        padding: 6px 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.3s ease;
      }

      .btn-edit {
        background: #667eea;
        color: white;
      }

      .btn-edit:hover {
        background: #5a6fd8;
        transform: translateY(-1px);
      }

      .btn-delete {
        background: #ff6b6b;
        color: white;
      }

      .btn-delete:hover {
        background: #ff5252;
        transform: translateY(-1px);
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
        width: 100%;
        margin-top: 10px;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: #f0f0f0;
        color: #333;
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        margin-right: 10px;
      }

      .btn-secondary:hover {
        background: #e0e0e0;
        transform: translateY(-1px);
      }

      .editor-actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 25px;
        padding-top: 20px;
        border-top: 2px solid #f0f0f0;
      }

      .quick-times {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 8px;
        margin-top: 10px;
      }

      .quick-time-btn {
        background: #f8f9ff;
        border: 2px solid #e0e0e0;
        border-radius: 6px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 0.85rem;
        transition: all 0.3s ease;
        text-align: center;
      }

      .quick-time-btn:hover {
        border-color: #667eea;
        background: #667eea;
        color: white;
      }

      .data-version {
        background: #e8f5e8;
        border-radius: 8px;
        padding: 10px;
        margin-top: 20px;
        text-align: center;
        font-size: 0.9rem;
        color: #2e7d32;
        border: 1px solid #c8e6c9;
      }

      /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
      @media screen and (max-width: 768px) {
        .editor-panel {
          padding: 20px;
          margin: 10px;
        }
        
        .time-inputs {
          grid-template-columns: 1fr;
          gap: 15px;
        }
        
        .time-separator {
          order: -1;
        }
        
        .quick-times {
          grid-template-columns: repeat(2, 1fr);
        }
        
        .course-item-edit {
          flex-direction: column;
          align-items: flex-start;
          gap: 10px;
        }
        
        .course-actions {
          width: 100%;
          justify-content: flex-end;
        }
      }

      .data-info {
        background: #e3f2fd;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        border-left: 4px solid #2196f3;
        font-size: 0.9rem;
        color: #1976d2;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ“ å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’</h1>
        <div class="current-date" id="currentDate"></div>
      </div>

      <div class="main-content">
        <div class="calendar-nav">
          <button class="nav-btn" id="prevBtn">â† å‰ä¸€å¤©</button>
          <div class="date-display" id="displayDate"></div>
          <button class="nav-btn" id="nextBtn">åä¸€å¤© â†’</button>
        </div>

        <div class="today-schedule">
          <div class="schedule-title">ä»Šæ—¥è¯¾ç¨‹å®‰æ’</div>
          <div id="scheduleContent"></div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-number" id="totalCourses">0</div>
            <div class="stat-label">ä»Šæ—¥è¯¾ç¨‹æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="courseHours">0</div>
            <div class="stat-label">è¯¾ç¨‹å°æ—¶æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="categoryCount">0</div>
            <div class="stat-label">è¯¾ç¨‹ç±»å‹</div>
          </div>
        </div>

        <button class="edit-toggle" onclick="handleEditClick()">
          âœï¸ ç¼–è¾‘è¯¾ç¨‹å®‰æ’
        </button>
        
        <button class="btn-secondary" onclick="clearLocalData()" style="margin-top: 10px; width: 100%;">
          ğŸ”„ é‡ç½®ä¸ºé»˜è®¤è¯¾ç¨‹æ•°æ®
        </button>

        <div class="data-version">
          ğŸ“Š æ•°æ®ç‰ˆæœ¬ï¼š2025.6.30.v2 | å·²ä¿®å¤SMKè¯¾ç¨‹æ—¶é—´ç»Ÿä¸€ä¸º13:00-15:00
        </div>
      </div>
    </div>

    <!-- ç¼–è¾‘å™¨ç•Œé¢ -->
    <div class="editor-overlay" id="editorOverlay">
      <div class="editor-panel">
        <div class="editor-header">
          <div class="editor-title">ğŸ“… è¯¾ç¨‹å®‰æ’ç¼–è¾‘å™¨</div>
          <button class="close-btn" onclick="handleCloseEditor()">Ã—</button>
        </div>

        <div class="form-group">
          <label class="form-label">ğŸ“… é€‰æ‹©æ—¥æœŸ</label>
          <input type="date" class="form-input" id="editDate" onchange="handleLoadDateCourses()">
        </div>

        <div class="course-list" id="courseList">
          <!-- å½“å‰æ—¥æœŸçš„è¯¾ç¨‹åˆ—è¡¨ -->
        </div>

        <div class="form-group">
          <label class="form-label">â° è¯¾ç¨‹æ—¶é—´</label>
          <div class="time-inputs">
            <input type="time" class="form-input" id="startTime" placeholder="å¼€å§‹æ—¶é—´">
            <div class="time-separator">è‡³</div>
            <input type="time" class="form-input" id="endTime" placeholder="ç»“æŸæ—¶é—´">
          </div>
          <div class="quick-times">
            <button class="quick-time-btn" onclick="handleSetQuickTime('09:00', '11:00')">09:00-11:00</button>
            <button class="quick-time-btn" onclick="handleSetQuickTime('13:00', '15:00')">13:00-15:00</button>
            <button class="quick-time-btn" onclick="handleSetQuickTime('15:30', '17:30')">15:30-17:30</button>
            <button class="quick-time-btn" onclick="handleSetQuickTime('19:00', '21:00')">19:00-21:00</button>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">ğŸ“š è¯¾ç¨‹åç§°</label>
          <input type="text" class="form-input" id="courseName" placeholder="è¯·è¾“å…¥è¯¾ç¨‹åç§°">
        </div>

        <div class="form-group">
          <label class="form-label">ğŸ¯ è¯¾ç¨‹ç±»å‹</label>
          <select class="form-select" id="courseType">
            <option value="smk">SMKè‹±è¯­</option>
            <option value="island">å²›ä¸»äº”ç«</option>
            <option value="teacher">æ™®è€å¸ˆåˆ·é¢˜</option>
            <option value="english">è‹±è¯­YH</option>
            <option value="exercise">ä½“è‚²é”»ç‚¼</option>
            <option value="homework">ä½œä¸šæ—¶é—´</option>
            <option value="art">è‰ºæœ¯è¯¾ç¨‹</option>
            <option value="other">å…¶ä»–</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">ğŸ“ å¤‡æ³¨è¯´æ˜ï¼ˆå¯é€‰ï¼‰</label>
          <textarea class="form-textarea" id="courseNote" placeholder="æ·»åŠ è¯¾ç¨‹å¤‡æ³¨æˆ–è¯´æ˜"></textarea>
        </div>

        <button class="btn-primary" onclick="handleSaveCourse()" id="saveBtn">
          â• æ·»åŠ è¯¾ç¨‹
        </button>

        <div class="editor-actions">
          <button class="btn-secondary" onclick="handleCloseEditor()">å–æ¶ˆ</button>
        </div>
      </div>
    </div>

    <script>
      // å¼ºåˆ¶æ¸…é™¤æ—§çš„localStorageæ•°æ®å¹¶ä½¿ç”¨æ–°çš„æ•°æ®ç‰ˆæœ¬
      const DATA_VERSION = '2025.6.30.v2';
      const STORAGE_KEY = 'scheduleData_v2';
      
      // æ£€æŸ¥å¹¶æ¸…é™¤æ—§ç‰ˆæœ¬æ•°æ®
      if (localStorage.getItem('scheduleData') || !localStorage.getItem('dataVersion') || localStorage.getItem('dataVersion') !== DATA_VERSION) {
        localStorage.removeItem('scheduleData');
        localStorage.setItem('dataVersion', DATA_VERSION);
        console.log('å·²æ¸…é™¤æ—§ç‰ˆæœ¬æ•°æ®ï¼Œä½¿ç”¨æ–°çš„è¯¾ç¨‹å®‰æ’');
      }

      // æ•°æ®æ¨¡å—
      window.ScheduleData = {
        // è¯¾ç¨‹ç±»å‹é…ç½®
        courseTypes: {
          smk: { name: 'SMKè‹±è¯­', color: '#ffe066', borderColor: '#ffd700' },
          island: { name: 'å²›ä¸»äº”ç«', color: '#66e0ff', borderColor: '#00bcd4' },
          teacher: { name: 'æ™®è€å¸ˆåˆ·é¢˜', color: '#ff9999', borderColor: '#f44336' },
          english: { name: 'è‹±è¯­YH', color: '#99ff99', borderColor: '#4caf50' },
          exercise: { name: 'ä½“è‚²é”»ç‚¼', color: '#90ee90', borderColor: '#32cd32' },
          homework: { name: 'ä½œä¸šæ—¶é—´', color: '#ffb6c1', borderColor: '#ff69b4' },
          art: { name: 'è‰ºæœ¯è¯¾ç¨‹', color: '#ffb3e6', borderColor: '#e91e63' },
          other: { name: 'å…¶ä»–', color: '#e0e0e0', borderColor: '#757575' }
        },

        // è¯¾ç¨‹å®‰æ’æ•°æ® - å·²ä¿®å¤æ‰€æœ‰SMKè¯¾ç¨‹æ—¶é—´ä¸º13:00-15:00
        schedules: {
          // 7æœˆç¬¬ä¸€å‘¨ 6.30(å‘¨ä¸€) - 7.6(å‘¨æ—¥)
          "2025-06-30": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-01": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-02": [],
          "2025-07-03": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-04": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-05": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-06": [],

          // 7æœˆç¬¬äºŒå‘¨ 7.7(å‘¨ä¸€) - 7.13(å‘¨æ—¥)
          "2025-07-07": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-08": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-09": [],
          "2025-07-10": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-11": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-12": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-13": [],

          // 7æœˆç¬¬ä¸‰å‘¨ 7.14(å‘¨ä¸€) - 7.20(å‘¨æ—¥)
          "2025-07-14": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-15": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-16": [],
          "2025-07-17": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-18": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-19": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-20": [],

          // 7æœˆç¬¬å››å‘¨ 7.21(å‘¨ä¸€) - 7.27(å‘¨æ—¥)
          "2025-07-21": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-22": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-23": [],
          "2025-07-24": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-25": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-26": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-27": [],

          // 7æœˆç¬¬äº”å‘¨ 7.28(å‘¨ä¸€) - 8.3(å‘¨æ—¥)
          "2025-07-28": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-29": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-07-30": [],
          "2025-07-31": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-01": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-02": [
            { time: "12:30-15:00", course: "å²›ä¸»äº”ç«", type: "island", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-03": [],

          // 8æœˆç¬¬ä¸€å‘¨ 8.4(å‘¨ä¸€) - 8.10(å‘¨æ—¥)
          "2025-08-04": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-05": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-06": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-07": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-08": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-09": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-10": [
            { time: "9:00-11:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],

          // 8æœˆç¬¬äºŒå‘¨ 8.11(å‘¨ä¸€) - 8.17(å‘¨æ—¥)
          "2025-08-11": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-12": [],
          "2025-08-13": [
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-14": [],
          "2025-08-15": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-16": [],
          "2025-08-17": [],

          // 8æœˆç¬¬ä¸‰å‘¨ 8.18(å‘¨ä¸€) - 8.24(å‘¨æ—¥)
          "2025-08-18": [
            { time: "13:00-15:00", course: "è‹±è¯­SMK", type: "smk", category: "å­¦ç§‘è¾…å¯¼" },
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-19": [],
          "2025-08-20": [
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-21": [],
          "2025-08-22": [
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-23": [
            { time: "19:00-21:00", course: "æ™®è€å¸ˆåˆ·é¢˜A", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-24": [
            { time: "19:00-21:00", course: "å®šä½è€ƒ", type: "teacher", category: "å­¦ç§‘è¾…å¯¼" }
          ],

          // 8æœˆç¬¬å››å‘¨ 8.25(å‘¨ä¸€) - 8.31(å‘¨æ—¥)
          "2025-08-25": [
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-26": [],
          "2025-08-27": [
            { time: "15:30-17:30", course: "è‹±è¯­YH", type: "english", category: "å­¦ç§‘è¾…å¯¼" }
          ],
          "2025-08-28": [],
          "2025-08-29": [],
          "2025-08-30": [],
          "2025-08-31": []
        },

        // è·å–æŒ‡å®šæ—¥æœŸçš„è¯¾ç¨‹å®‰æ’
        getScheduleByDate: function(dateStr) {
          return this.schedules[dateStr] || [];
        },

        // è·å–è¯¾ç¨‹ç±»å‹ä¿¡æ¯
        getCourseType: function(type) {
          return this.courseTypes[type] || this.courseTypes.other;
        },

        // æ·»åŠ è¯¾ç¨‹åˆ°æŒ‡å®šæ—¥æœŸ
        addCourse: function(dateStr, courseData) {
          if (!this.schedules[dateStr]) {
            this.schedules[dateStr] = [];
          }
          
          courseData.id = Date.now() + Math.random();
          this.schedules[dateStr].push(courseData);
          this.saveToLocal();
          return courseData.id;
        },

        // æ›´æ–°è¯¾ç¨‹
        updateCourse: function(dateStr, courseId, newData) {
          if (!this.schedules[dateStr]) return false;
          
          var courseIndex = -1;
          for (var i = 0; i < this.schedules[dateStr].length; i++) {
            if (this.schedules[dateStr][i].id == courseId) {
              courseIndex = i;
              break;
            }
          }
          
          if (courseIndex !== -1) {
            newData.id = courseId;
            this.schedules[dateStr][courseIndex] = newData;
            this.saveToLocal();
            return true;
          }
          return false;
        },

        // åˆ é™¤è¯¾ç¨‹
        deleteCourse: function(dateStr, courseId) {
          if (!this.schedules[dateStr]) return false;
          
          var courseIndex = -1;
          for (var i = 0; i < this.schedules[dateStr].length; i++) {
            if (this.schedules[dateStr][i].id == courseId) {
              courseIndex = i;
              break;
            }
          }
          
          if (courseIndex !== -1) {
            this.schedules[dateStr].splice(courseIndex, 1);
            this.saveToLocal();
            return true;
          }
          return false;
        },

        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        saveToLocal: function() {
          try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(this.schedules));
          } catch (e) {
            console.log('æœ¬åœ°å­˜å‚¨å¤±è´¥:', e);
          }
        },

        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½
        loadFromLocal: function() {
          try {
            var savedData = localStorage.getItem(STORAGE_KEY);
            if (savedData) {
              var parsed = JSON.parse(savedData);
              for (var date in parsed) {
                this.schedules[date] = parsed[date];
              }
            }
          } catch (e) {
            console.log('æœ¬åœ°å­˜å‚¨åŠ è½½å¤±è´¥:', e);
          }
        },

        // åˆå§‹åŒ–æ•°æ®
        init: function() {
          // ä¸ºç°æœ‰è¯¾ç¨‹æ·»åŠ ID
          for (var date in this.schedules) {
            for (var i = 0; i < this.schedules[date].length; i++) {
              if (!this.schedules[date][i].id) {
                this.schedules[date][i].id = Date.now() + Math.random() + i;
              }
            }
          }
          this.loadFromLocal();
        }
      };

      // ç¼–è¾‘å™¨æ¨¡å—
      window.ScheduleEditor = {
        currentEditingId: null,
        currentEditingDate: null,

        openEditor: function(date) {
          var today = new Date();
          var year = today.getFullYear();
          var month = today.getMonth() + 1;
          var day = today.getDate();
          var dateStr = date || (year + "-" + (month < 10 ? "0" + month : month) + "-" + (day < 10 ? "0" + day : day));
          
          document.getElementById('editDate').value = dateStr;
          document.getElementById('editorOverlay').style.display = 'flex';
          
          this.loadDateCourses();
          this.clearForm();
        },

        closeEditor: function() {
          document.getElementById('editorOverlay').style.display = 'none';
          this.clearForm();
          this.currentEditingId = null;
          this.currentEditingDate = null;
        },

        loadDateCourses: function() {
          var dateStr = document.getElementById('editDate').value;
          if (!dateStr) return;

          var courses = window.ScheduleData.getScheduleByDate(dateStr);
          var courseListHtml = '';

          if (courses.length === 0) {
            courseListHtml = '<div style="text-align: center; color: #666; padding: 20px;">ğŸ“… å½“å‰æ—¥æœŸæ²¡æœ‰å®‰æ’è¯¾ç¨‹</div>';
          } else {
            for (var i = 0; i < courses.length; i++) {
              var course = courses[i];
              
              courseListHtml += 
                '<div class="course-item-edit">' +
                  '<div class="course-info">' +
                    '<div class="course-time-edit">' + course.time + '</div>' +
                    '<div class="course-name-edit">' + course.course + '</div>' +
                  '</div>' +
                  '<div class="course-actions">' +
                    '<button class="btn-small btn-edit" onclick="handleEditCourse(\'' + course.id + '\', \'' + dateStr + '\')">ç¼–è¾‘</button>' +
                    '<button class="btn-small btn-delete" onclick="handleDeleteCourse(\'' + course.id + '\', \'' + dateStr + '\')">åˆ é™¤</button>' +
                  '</div>' +
                '</div>';
            }
          }

          document.getElementById('courseList').innerHTML = courseListHtml;
        },

        setQuickTime: function(startTime, endTime) {
          document.getElementById('startTime').value = startTime;
          document.getElementById('endTime').value = endTime;
        },

        clearForm: function() {
          document.getElementById('startTime').value = '';
          document.getElementById('endTime').value = '';
          document.getElementById('courseName').value = '';
          document.getElementById('courseType').value = 'smk';
          document.getElementById('courseNote').value = '';
          document.getElementById('saveBtn').innerHTML = 'â• æ·»åŠ è¯¾ç¨‹';
          this.currentEditingId = null;
        },

        editCourse: function(courseId, dateStr) {
          var courses = window.ScheduleData.getScheduleByDate(dateStr);
          var course = null;
          for (var i = 0; i < courses.length; i++) {
            if (courses[i].id == courseId) {
              course = courses[i];
              break;
            }
          }
          
          if (!course) return;

          var timeMatch = course.time.match(/(\d+):(\d+)-(\d+):(\d+)/);
          if (timeMatch) {
            document.getElementById('startTime').value = timeMatch[1] + ':' + timeMatch[2];
            document.getElementById('endTime').value = timeMatch[3] + ':' + timeMatch[4];
          }

          document.getElementById('courseName').value = course.course;
          document.getElementById('courseType').value = course.type;
          document.getElementById('courseNote').value = course.note || '';
          document.getElementById('saveBtn').innerHTML = 'âœ… æ›´æ–°è¯¾ç¨‹';

          this.currentEditingId = courseId;
          this.currentEditingDate = dateStr;
        },

        deleteCourse: function(courseId, dateStr) {
          if (confirm('ç¡®å®šè¦åˆ é™¤è¿™é—¨è¯¾ç¨‹å—ï¼Ÿ')) {
            window.ScheduleData.deleteCourse(dateStr, courseId);
            this.loadDateCourses();
            
            if (typeof currentDate !== 'undefined' && typeof formatDate === 'function') {
              var currentDisplayDate = formatDate(currentDate);
              if (dateStr === currentDisplayDate) {
                updateDisplay();
              }
            }
          }
        },

        saveCourse: function() {
          var dateStr = document.getElementById('editDate').value;
          var startTime = document.getElementById('startTime').value;
          var endTime = document.getElementById('endTime').value;
          var courseName = document.getElementById('courseName').value.trim();
          var courseType = document.getElementById('courseType').value;
          var courseNote = document.getElementById('courseNote').value.trim();

          if (!dateStr || !startTime || !endTime || !courseName) {
            alert('è¯·å¡«å†™å®Œæ•´çš„è¯¾ç¨‹ä¿¡æ¯ï¼ˆæ—¥æœŸã€æ—¶é—´ã€è¯¾ç¨‹åç§°ä¸ºå¿…å¡«é¡¹ï¼‰');
            return;
          }

          if (startTime >= endTime) {
            alert('ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´');
            return;
          }

          var courseData = {
            time: startTime + '-' + endTime,
            course: courseName,
            type: courseType,
            category: "å­¦ç§‘è¾…å¯¼",
            note: courseNote
          };

          if (this.currentEditingId) {
            window.ScheduleData.updateCourse(this.currentEditingDate, this.currentEditingId, courseData);
            alert('è¯¾ç¨‹æ›´æ–°æˆåŠŸï¼');
          } else {
            window.ScheduleData.addCourse(dateStr, courseData);
            alert('è¯¾ç¨‹æ·»åŠ æˆåŠŸï¼');
          }

          this.loadDateCourses();
          this.clearForm();

          if (typeof currentDate !== 'undefined' && typeof formatDate === 'function') {
            var currentDisplayDate = formatDate(currentDate);
            if (dateStr === currentDisplayDate) {
              updateDisplay();
            }
          }
        }
      };

      // ä¸»ç¨‹åºä»£ç 
      var currentDate = new Date();
      var longPressTimer = null;
      var longPressInterval = null;
      var touchStartTime = 0;
      var touchEndTime = 0;
      var isLongPress = false;

      function formatDate(date) {
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        return year + "-" + (month < 10 ? "0" + month : month) + "-" + (day < 10 ? "0" + day : day);
      }

      function formatDisplayDate(date) {
        var weekdays = ["å‘¨æ—¥", "å‘¨ä¸€", "å‘¨äºŒ", "å‘¨ä¸‰", "å‘¨å››", "å‘¨äº”", "å‘¨å…­"];
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var weekday = weekdays[date.getDay()];
        return year + "å¹´" + month + "æœˆ" + day + "æ—¥ " + weekday;
      }

      function updateDisplay() {
        var dateStr = formatDate(currentDate);
        var displayStr = formatDisplayDate(currentDate);
        var todayStr = formatDisplayDate(new Date());

        document.getElementById("currentDate").innerHTML = todayStr;
        document.getElementById("displayDate").innerHTML = displayStr;

        var courses = window.ScheduleData.getScheduleByDate(dateStr);
        var scheduleContent = document.getElementById("scheduleContent");

        if (courses.length === 0) {
          scheduleContent.innerHTML = '<div class="no-courses">ğŸ‰ ä»Šå¤©æ²¡æœ‰å®‰æ’è¯¾ç¨‹ï¼Œå¯ä»¥å¥½å¥½ä¼‘æ¯å“¦ï¼</div>';
        } else {
          var html = "";
          for (var i = 0; i < courses.length; i++) {
            var course = courses[i];
            html += '<div class="course-item course-' + course.type + '">' +
                    '<div class="course-time">' + course.time + '</div>' +
                    '<div class="course-name">' + course.course + '</div>' +
                    '</div>';
          }
          scheduleContent.innerHTML = html;
        }

        updateStats(courses);
      }

      function updateStats(courses) {
        document.getElementById("totalCourses").innerHTML = courses.length;

        var totalHours = 0;
        for (var i = 0; i < courses.length; i++) {
          var course = courses[i];
          var timeMatch = course.time.match(/(\d+):(\d+)-(\d+):(\d+)/);
          if (timeMatch) {
            var startHour = parseInt(timeMatch[1]);
            var startMin = parseInt(timeMatch[2]);
            var endHour = parseInt(timeMatch[3]);
            var endMin = parseInt(timeMatch[4]);
            var hours = (endHour * 60 + endMin - startHour * 60 - startMin) / 60;
            totalHours += hours;
          }
        }
        
        document.getElementById("courseHours").innerHTML = totalHours.toFixed(1);

        var categories = [];
        for (var i = 0; i < courses.length; i++) {
          var category = courses[i].category || "å­¦ç§‘è¾…å¯¼";
          if (categories.indexOf(category) === -1) {
            categories.push(category);
          }
        }
        
        document.getElementById("categoryCount").innerHTML = categories.length;
      }

      function changeDate(days) {
        currentDate.setDate(currentDate.getDate() + days);
        updateDisplay();
      }

      function bindEvents() {
        var prevBtn = document.getElementById('prevBtn');
        var nextBtn = document.getElementById('nextBtn');

        if (prevBtn) {
          prevBtn.addEventListener('click', function() { changeDate(-1); });
        }

        if (nextBtn) {
          nextBtn.addEventListener('click', function() { changeDate(1); });
        }
      }

      // å…¨å±€å‡½æ•°
      function handleEditClick() {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.openEditor();
        }
      }

      function handleCloseEditor() {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.closeEditor();
        }
      }

      function handleLoadDateCourses() {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.loadDateCourses();
        }
      }

      function handleSetQuickTime(start, end) {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.setQuickTime(start, end);
        }
      }

      function handleEditCourse(courseId, dateStr) {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.editCourse(courseId, dateStr);
        }
      }

      function handleDeleteCourse(courseId, dateStr) {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.deleteCourse(courseId, dateStr);
        }
      }

      function handleSaveCourse() {
        if (window.ScheduleEditor) {
          window.ScheduleEditor.saveCourse();
        }
      }

      function clearLocalData() {
        if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æœ¬åœ°ä¿®æ”¹ï¼Œæ¢å¤ä¸ºé»˜è®¤è¯¾ç¨‹å®‰æ’å—ï¼Ÿ\n\næ³¨æ„ï¼šè¿™å°†åˆ é™¤ä½ ä¹‹å‰åšçš„æ‰€æœ‰è¯¾ç¨‹ä¿®æ”¹ï¼')) {
          localStorage.removeItem(STORAGE_KEY);
          localStorage.removeItem('scheduleData'); // ä¹Ÿæ¸…é™¤æ—§ç‰ˆæœ¬çš„key
          localStorage.setItem('dataVersion', DATA_VERSION);
          
          window.ScheduleData.init();
          updateDisplay();
          
          alert('å·²æ¢å¤ä¸ºé»˜è®¤è¯¾ç¨‹å®‰æ’ï¼æ‰€æœ‰SMKè¯¾ç¨‹æ—¶é—´å·²ç»Ÿä¸€ä¸º13:00-15:00');
        }
      }

      // åˆå§‹åŒ–
      function init() {
        window.ScheduleData.init();
        updateDisplay();
        bindEvents();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    </script>
  </body>
</html>
          "
