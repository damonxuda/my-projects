<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0" />

    <!-- ç¤¾äº¤åª’ä½“åˆ†äº«é¢„è§ˆ -->
    <meta property="og:title" content="å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’" />
    <meta property="og:description" content="2025å¹´æš‘å‡å­¦ä¹ è®¡åˆ’ï¼Œè¯¾ç¨‹å®‰æ’ä¸€ç›®äº†ç„¶ï¼Œæ”¯æŒåœ¨çº¿ç¼–è¾‘å’Œè¯¾ç¨‹æé†’" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=1200&h=630&fit=crop&auto=format" />
    <meta property="og:url" content="https://damonxuda.github.io/course-schedule/" />
    <meta property="og:type" content="website" />
    
    <!-- å¾®ä¿¡åˆ†äº«ä¼˜åŒ– -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’" />
    <meta name="twitter:description" content="2025å¹´æš‘å‡å­¦ä¹ è®¡åˆ’ï¼Œè¯¾ç¨‹å®‰æ’ä¸€ç›®äº†ç„¶ï¼Œæ”¯æŒåœ¨çº¿ç¼–è¾‘å’Œè¯¾ç¨‹æé†’" />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=1200&h=630&fit=crop&auto=format" />

    <!-- PWA æ”¯æŒ -->
    <meta name="theme-color" content="#667eea" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="è¯¾ç¨‹è¡¨" />
    <link
      rel="apple-touch-icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23667eea'/><text x='50' y='60' font-size='50' text-anchor='middle' fill='white'>ğŸ“š</text></svg>"
    />
    <link
      rel="manifest"
      href="data:application/json,{
        'name': 'æš‘å‡è¯¾ç¨‹æ—¥å†',
        'short_name': 'è¯¾ç¨‹è¡¨',
        'start_url': '.',
        'display': 'standalone',
        'background_color': '#667eea',
        'theme_color': '#667eea',
        'icons': [
            {
                'src': 'data:image/svg+xml,<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 100 100\\'><rect width=\\'100\\' height=\\'100\\' fill=\\'%23667eea\\'/><text x=\\'50\\' y=\\'60\\' font-size=\\'50\\' text-anchor=\\'middle\\' fill=\\'white\\'>ğŸ“š</text></svg>',
                'sizes': '192x192',
                'type': 'image/svg+xml'
            }
        ]
    }"
    />
    <title>æš‘å‡è¯¾ç¨‹æ—¥å†æé†’</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        /* é˜²æ­¢æ„å¤–ç¼©æ”¾ */
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      body {
        font-family: "Microsoft YaHei", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        /* é˜²æ­¢é¡µé¢ç¼©æ”¾ */
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        touch-action: manipulation;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 1.8rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .current-date {
        font-size: 1.3rem;
        opacity: 0.9;
      }

      .main-content {
        padding: 30px;
      }

      .today-schedule {
        background: #f8f9ff;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 30px;
        border-left: 5px solid #667eea;
      }

      .schedule-title {
        font-size: 1.5rem;
        color: #333;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
      }

      .schedule-title::before {
        content: "ğŸ“…";
        margin-right: 10px;
        font-size: 1.8rem;
      }

      .course-item {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease;
      }

      .course-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .course-time {
        font-weight: bold;
        color: #ff6b6b;
        font-size: 1.1rem;
        margin-bottom: 5px;
      }

      .course-name {
        color: #333;
        font-size: 1rem;
      }

      .course-smk {
        background: #ffe066;
        border-left-color: #ffd700;
      }

      .course-island {
        background: #66e0ff;
        border-left-color: #00bcd4;
      }

      .course-teacher {
        background: #ff9999;
        border-left-color: #f44336;
      }

      .course-english {
        background: #99ff99;
        border-left-color: #4caf50;
      }

      .course-exercise {
        background: #90ee90;
        border-left-color: #32cd32;
      }

      .course-homework {
        background: #ffb6c1;
        border-left-color: #ff69b4;
      }

      .course-art {
        background: #ffb3e6;
        border-left-color: #e91e63;
      }

      .course-other {
        background: #e0e0e0;
        border-left-color: #757575;
      }

      .no-courses {
        text-align: center;
        color: #666;
        font-size: 1.2rem;
        padding: 40px;
      }

      .calendar-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .nav-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.3s ease;
        /* é˜²æ­¢æŒ‰é’®å¯¼è‡´ç¼©æ”¾ */
        touch-action: manipulation;
      }

      .nav-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 3px 10px rgba(102, 126, 234, 0.4);
      }

      .date-display {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
      }

      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        transform: translateX(400px);
        transition: transform 0.5s ease;
        z-index: 1000;
        max-width: 300px;
      }

      .notification.show {
        transform: translateX(0);
      }

      .notification h3 {
        margin-bottom: 10px;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .stat-card {
        background: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        color: #666;
        margin-top: 5px;
      }

      .category-stats {
        background: #f8f9ff;
        border-radius: 12px;
        padding: 25px;
        margin-top: 30px;
        border-left: 5px solid #4caf50;
      }

      .category-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .category-item {
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-name {
        font-weight: bold;
        color: #333;
      }

      .category-hours {
        color: #667eea;
        font-size: 1.1rem;
        font-weight: bold;
      }

      .toggle-stats {
        background: linear-gradient(135deg, #4caf50, #45a049);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9rem;
        margin-top: 15px;
        transition: all 0.3s ease;
        touch-action: manipulation;
      }

      .toggle-stats:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
      }

      .edit-panel {
        background: #f0f8ff;
        border-radius: 12px;
        padding: 25px;
        margin-top: 30px;
        border-left: 5px solid #ff6b6b;
        display: none;
      }

      .edit-form {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
      }

      .form-group label {
        margin-bottom: 5px;
        color: #333;
        font-weight: bold;
      }

      .form-group input,
      .form-group select {
        padding: 10px;
        border: 2px solid #e2e8f0;
        border-radius: 6px;
        font-size: 1rem;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #667eea;
      }

      .form-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
        touch-action: manipulation;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
      }

      .btn-success {
        background: linear-gradient(135deg, #4caf50, #45a049);
        color: white;
      }

      .btn-danger {
        background: linear-gradient(135deg, #f44336, #d32f2f);
        color: white;
      }

      .btn-secondary {
        background: linear-gradient(135deg, #6c757d, #5a6268);
        color: white;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .course-list {
        background: white;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        max-height: 300px;
        overflow-y: auto;
      }

      .course-list-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-bottom: 1px solid #eee;
        transition: background 0.2s ease;
      }

      .course-list-item:hover {
        background: #f5f5f5;
      }

      .course-list-item:last-child {
        border-bottom: none;
      }

      .course-info {
        flex: 1;
      }

      .course-actions {
        display: flex;
        gap: 5px;
      }

      .btn-small {
        padding: 5px 10px;
        font-size: 0.8rem;
      }

      .edit-toggle {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
        margin-top: 20px;
        transition: all 0.3s ease;
        touch-action: manipulation;
      }

      .edit-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
      }

      .success-message {
        background: #d4edda;
        color: #155724;
        padding: 10px;
        border-radius: 6px;
        margin-top: 10px;
        display: none;
      }

      .error-message {
        background: #f8d7da;
        color: #721c24;
        padding: 10px;
        border-radius: 6px;
        margin-top: 10px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ“ å­æ°æš‘å‡è¯¾ç¨‹å®‰æ’</h1>
        <div class="current-date" id="currentDate"></div>
      </div>

      <div class="main-content">
        <div class="calendar-nav">
          <button class="nav-btn" id="prevBtn">â† å‰ä¸€å¤©</button>
          <div class="date-display" id="displayDate"></div>
          <button class="nav-btn" id="nextBtn">åä¸€å¤© â†’</button>
        </div>

        <div class="today-schedule">
          <div class="schedule-title">ä»Šæ—¥è¯¾ç¨‹å®‰æ’</div>
          <div id="scheduleContent"></div>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div class="stat-number" id="totalCourses">0</div>
            <div class="stat-label">ä»Šæ—¥è¯¾ç¨‹æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="courseHours">0</div>
            <div class="stat-label">è¯¾ç¨‹å°æ—¶æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="categoryCount">0</div>
            <div class="stat-label">è¯¾ç¨‹ç±»å‹</div>
          </div>
        </div>

        <!-- åˆ†ç±»ç»Ÿè®¡åŒºåŸŸ -->
        <div class="category-stats" id="categoryStats" style="display: none">
          <h3 style="margin-bottom: 20px; color: #333">ğŸ“Š ä»Šæ—¥åˆ†ç±»ç»Ÿè®¡</h3>
          <div class="category-grid" id="categoryGrid"></div>
        </div>

        <!-- ç¼–è¾‘è¯¾ç¨‹æŒ‰é’® -->
        <button class="edit-toggle" onclick="toggleEditPanel()">
          âœï¸ ç¼–è¾‘è¯¾ç¨‹å®‰æ’
        </button>

        <!-- ç¼–è¾‘é¢æ¿ -->
        <div class="edit-panel" id="editPanel">
          <h3 style="margin-bottom: 20px; color: #333">ğŸ“ ç¼–è¾‘è¯¾ç¨‹å®‰æ’</h3>

          <div class="edit-form">
            <div class="form-group">
              <label for="editDate">æ—¥æœŸ</label>
              <input
                type="date"
                id="editDate"
                min="2025-06-30"
                max="2025-12-31"
              />
            </div>
            <div class="form-group">
              <label for="startTime">å¼€å§‹æ—¶é—´</label>
              <input type="time" id="startTime" />
            </div>
            <div class="form-group">
              <label for="endTime">ç»“æŸæ—¶é—´</label>
              <input type="time" id="endTime" />
            </div>
            <div class="form-group">
              <label for="courseSelect">é€‰æ‹©è¯¾ç¨‹</label>
              <select id="courseSelect" onchange="handleCourseSelect()">
                <option value="">-- é€‰æ‹©ç°æœ‰è¯¾ç¨‹ --</option>
                <option value="è‹±è¯­SMK (1ç‚¹-3ç‚¹)">è‹±è¯­SMK (1ç‚¹-3ç‚¹)</option>
                <option value="å²›ä¸»äº”ç«">å²›ä¸»äº”ç«</option>
                <option value="æ™®è€å¸ˆåˆ·é¢˜A">æ™®è€å¸ˆåˆ·é¢˜A</option>
                <option value="è‹±è¯­YH">è‹±è¯­YH</option>
                <option value="custom">-- è¾“å…¥è‡ªå®šä¹‰è¯¾ç¨‹ --</option>
              </select>
            </div>
            <div
              class="form-group"
              id="customCourseGroup"
              style="display: none"
            >
              <label for="customCourseName">è‡ªå®šä¹‰è¯¾ç¨‹åç§°</label>
              <input
                type="text"
                id="customCourseName"
                placeholder="å¦‚ï¼šæ¸¸æ³³ã€ç”»ç”»ã€ä½œä¸šç­‰"
              />
            </div>
            <div class="form-group">
              <label for="courseCategory">åˆ†ç±»</label>
              <select id="courseCategory">
                <option value="å­¦ç§‘è¾…å¯¼">å­¦ç§‘è¾…å¯¼</option>
                <option value="ä½“è‚²é”»ç‚¼">ä½“è‚²é”»ç‚¼</option>
                <option value="ä½œä¸šå®Œæˆ">ä½œä¸šå®Œæˆ</option>
                <option value="å…´è¶£çˆ±å¥½">å…´è¶£çˆ±å¥½</option>
                <option value="ç”Ÿæ´»æŠ€èƒ½">ç”Ÿæ´»æŠ€èƒ½</option>
                <option value="ç¤¾äº¤æ´»åŠ¨">ç¤¾äº¤æ´»åŠ¨</option>
              </select>
            </div>
          </div>

          <div class="form-buttons">
            <button class="btn btn-success" onclick="addCourse()">
              â• æ·»åŠ è¯¾ç¨‹
            </button>
            <button class="btn btn-primary" onclick="viewDateCourses()">
              ğŸ‘€ æŸ¥çœ‹å½“å¤©è¯¾ç¨‹
            </button>
            <button class="btn btn-secondary" onclick="clearForm()">
              ğŸ”„ æ¸…ç©ºè¡¨å•
            </button>
            <button class="btn btn-danger" onclick="clearAllCourses()">
              ğŸ—‘ï¸ æ¸…ç©ºå½“å¤©æ‰€æœ‰è¯¾ç¨‹
            </button>
          </div>

          <div class="success-message" id="successMessage"></div>
          <div class="error-message" id="errorMessage"></div>

          <div class="course-list" id="courseList"></div>
        </div>
      </div>
    </div>

    <div class="notification" id="notification">
      <h3>ğŸ“¢ è¯¾ç¨‹æé†’</h3>
      <p id="notificationText"></p>
    </div>

    <script>
      // é˜²æ­¢é¡µé¢ç¼©æ”¾çš„é¢å¤–å¤„ç†
      document.addEventListener('gesturestart', function (e) {
        e.preventDefault();
      });

      document.addEventListener('gesturechange', function (e) {
        e.preventDefault();
      });

      document.addEventListener('gestureend', function (e) {
        e.preventDefault();
      });

      // ä¿®æ­£åçš„è¯¾ç¨‹å®‰æ’æ•°æ®
      const scheduleData = {
        // ç¬¬ä¸€å‘¨ 6.30(å‘¨ä¸€) - 7.6(å‘¨æ—¥)
        "2025-06-30": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "19:00-21:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-01": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-02": [],
        "2025-07-03": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "19:00-21:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-04": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-05": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-06": [],
        
        // ç¬¬äºŒå‘¨ 7.7(å‘¨ä¸€) - 7.13(å‘¨æ—¥)
        "2025-07-07": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "19:00-21:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-08": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-09": [],
        "2025-07-10": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-11": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-12": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-13": [],

        // ç»§ç»­å…¶ä»–æ—¥æœŸ...
        "2025-07-14": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "19:00-21:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-15": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-16": [],
        "2025-07-17": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-18": [
          {
            time: "12:30-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-19": [
          {
            time: "12:30-15:00",
            course: "å²›ä¸»äº”ç«",
            type: "island",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
        "2025-07-20": [],

        // 8æœˆéƒ¨åˆ† - æŒ‰å®é™…çº¸è´¨è¡¨æ ¼æ ¸å¯¹
        "2025-08-04": [
          {
            time: "9:00-11:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "13:00-15:00",
            course: "è‹±è¯­SMK (1ç‚¹-3ç‚¹)",
            type: "smk",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "15:30-17:30",
            course: "è‹±è¯­YH",
            type: "english",
            category: "å­¦ç§‘è¾…å¯¼",
          },
          {
            time: "19:00-21:00",
            course: "æ™®è€å¸ˆåˆ·é¢˜A",
            type: "teacher",
            category: "å­¦ç§‘è¾…å¯¼",
          },
        ],
      };

      let currentDate = new Date();

      // é•¿æŒ‰åŠŸèƒ½å˜é‡
      let longPressTimer = null;
      let longPressInterval = null;
      let isLongPressing = false;

      function formatDate(date) {
        return (
          date.getFullYear() +
          "-" +
          String(date.getMonth() + 1).padStart(2, "0") +
          "-" +
          String(date.getDate()).padStart(2, "0")
        );
      }

      function formatDisplayDate(date) {
        const weekdays = [
          "å‘¨æ—¥",
          "å‘¨ä¸€",
          "å‘¨äºŒ",
          "å‘¨ä¸‰",
          "å‘¨å››",
          "å‘¨äº”",
          "å‘¨å…­",
        ];
        return `${date.getFullYear()}å¹´${
          date.getMonth() + 1
        }æœˆ${date.getDate()}æ—¥ ${weekdays[date.getDay()]}`;
      }

      function updateDisplay() {
        const dateStr = formatDate(currentDate);
        const displayStr = formatDisplayDate(currentDate);

        document.getElementById("currentDate").textContent = formatDisplayDate(
          new Date()
        );
        document.getElementById("displayDate").textContent = displayStr;

        const courses = scheduleData[dateStr] || [];
        const scheduleContent = document.getElementById("scheduleContent");

        if (courses.length === 0) {
          scheduleContent.innerHTML =
            '<div class="no-courses">ğŸ‰ ä»Šå¤©æ²¡æœ‰å®‰æ’è¯¾ç¨‹ï¼Œå¯ä»¥å¥½å¥½ä¼‘æ¯å“¦ï¼</div>';
        } else {
          scheduleContent.innerHTML = courses
            .map(
              (course) => `
                    <div class="course-item course-${course.type}">
                        <div class="course-time">${course.time}</div>
                        <div class="course-name">${course.course}</div>
                    </div>
                `
            )
            .join("");
        }

        updateStats(courses);
      }

      function updateStats(courses) {
        document.getElementById("totalCourses").textContent = courses.length;

        let totalHours = 0;
        courses.forEach((course) => {
          const timeMatch = course.time.match(/(\d+):(\d+)-(\d+):(\d+)/);
          if (timeMatch) {
            const startHour = parseInt(timeMatch[1]);
            const startMin = parseInt(timeMatch[2]);
            const endHour = parseInt(timeMatch[3]);
            const endMin = parseInt(timeMatch[4]);
            const hours =
              (endHour * 60 + endMin - startHour * 60 - startMin) / 60;
            totalHours += hours;
          }
        });
        document.getElementById("courseHours").textContent =
          totalHours.toFixed(1);

        const categories = new Set(
          courses.map((course) => course.category || "å­¦ç§‘è¾…å¯¼")
        );
        document.getElementById("categoryCount").textContent = categories.size;

        updateCategoryStats(courses);
      }

      function updateCategoryStats(courses) {
        const categoryStats = {};

        courses.forEach((course) => {
          const category = course.category || "å­¦ç§‘è¾…å¯¼";
          if (!categoryStats[category]) {
            categoryStats[category] = { count: 0, hours: 0 };
          }
          categoryStats[category].count++;

          const timeMatch = course.time.match(/(\d+):(\d+)-(\d+):(\d+)/);
          if (timeMatch) {
            const startHour = parseInt(timeMatch[1]);
            const startMin = parseInt(timeMatch[2]);
            const endHour = parseInt(timeMatch[3]);
            const endMin = parseInt(timeMatch[4]);
            const hours =
              (endHour * 60 + endMin - startHour * 60 - startMin) / 60;
            categoryStats[category].hours += hours;
          }
        });

        const categoryGrid = document.getElementById("categoryGrid");
        if (Object.keys(categoryStats).length > 0) {
          categoryGrid.innerHTML = Object.entries(categoryStats)
            .map(
              ([category, stats]) => `
                    <div class="category-item">
                        <div class="category-name">${getCategoryEmoji(
                          category
                        )} ${category}</div>
                        <div class="category-hours">${stats.hours.toFixed(
                          1
                        )}h (${stats.count}é¡¹)</div>
                    </div>
                `
            )
            .join("");

          if (!document.querySelector(".toggle-stats")) {
            const toggleButton = document.createElement("button");
            toggleButton.className = "toggle-stats";
            toggleButton.textContent = "ğŸ“Š æ˜¾ç¤ºåˆ†ç±»ç»Ÿè®¡";
            toggleButton.onclick = toggleCategoryStats;
            document.querySelector(".today-schedule").appendChild(toggleButton);
          }
        }
      }

      function getCategoryEmoji(category) {
        const emojiMap = {
          å­¦ç§‘è¾…å¯¼: "ğŸ“š",
          ä½“è‚²é”»ç‚¼: "ğŸƒ",
          ä½œä¸šå®Œæˆ: "âœï¸",
          å…´è¶£çˆ±å¥½: "ğŸ¨",
          ç”Ÿæ´»æŠ€èƒ½: "ğŸ”§",
          ç¤¾äº¤æ´»åŠ¨: "ğŸ‘¥",
        };
        return emojiMap[category] || "ğŸ“‹";
      }

      function toggleCategoryStats() {
        const categoryStats = document.getElementById("categoryStats");
        const button = document.querySelector(".toggle-stats");

        if (categoryStats.style.display === "none") {
          categoryStats.style.display = "block";
          button.textContent = "ğŸ“Š éšè—åˆ†ç±»ç»Ÿè®¡";
        } else {
          categoryStats.style.display = "none";
          button.textContent = "ğŸ“Š æ˜¾ç¤ºåˆ†ç±»ç»Ÿè®¡";
        }
      }

      function changeDate(days) {
        currentDate.setDate(currentDate.getDate() + days);
        updateDisplay();
      }

      // é•¿æŒ‰åŠŸèƒ½
      function startLongPress(direction) {
        isLongPressing = true;
        longPressTimer = setTimeout(() => {
          longPressInterval = setInterval(() => {
            if (isLongPressing) {
              changeDate(direction);
            }
          }, 300);
        }, 500);
      }

      function stopLongPress() {
        isLongPressing = false;
        if (longPressTimer) {
          clearTimeout(longPressTimer);
          longPressTimer = null;
        }
        if (longPressInterval) {
          clearInterval(longPressInterval);
          longPressInterval = null;
        }
      }

      // ç»‘å®šäº‹ä»¶
      function bindEvents() {
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // å‰ä¸€å¤©æŒ‰é’®
        prevBtn.addEventListener('click', () => changeDate(-1));
        prevBtn.addEventListener('mousedown', () => startLongPress(-1));
        prevBtn.addEventListener('mouseup', stopLongPress);
        prevBtn.addEventListener('mouseleave', stopLongPress);
        prevBtn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          startLongPress(-1);
        });
        prevBtn.addEventListener('touchend', stopLongPress);

        // åä¸€å¤©æŒ‰é’®
        nextBtn.addEventListener('click', () => changeDate(1));
        nextBtn.addEventListener('mousedown', () => startLongPress(1));
        nextBtn.addEventListener('mouseup', stopLongPress);
        nextBtn.addEventListener('mouseleave', stopLongPress);
        nextBtn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          startLongPress(1);
        });
        nextBtn.addEventListener('touchend', stopLongPress);
      }

      function showNotification(text) {
        const notification = document.getElementById("notification");
        document.getElementById("notificationText").textContent = text;
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 5000);
      }

      function checkUpcomingCourses() {
        const now = new Date();
        const dateStr = formatDate(now);
        const courses = scheduleData[dateStr] || [];

        courses.forEach((course) => {
          const timeMatch = course.time.match(/(\d+):(\d+)/);
          if (timeMatch) {
            const courseHour = parseInt(timeMatch[1]);
            const courseMin = parseInt(timeMatch[2]);
            const courseTime = new Date(now);
            courseTime.setHours(courseHour, courseMin, 0, 0);

            const timeDiff = courseTime - now;
            if (timeDiff > 0 && timeDiff <= 30 * 60 * 1000) {
              showNotification(
                `${course.course} å°†åœ¨ ${Math.ceil(
                  timeDiff / (60 * 1000)
                )} åˆ†é’Ÿåå¼€å§‹ï¼`
              );
            }
          }
        });
      }

      // ç¼–è¾‘åŠŸèƒ½
      function toggleEditPanel() {
        const panel = document.getElementById("editPanel");
        const button = document.querySelector(".edit-toggle");

        if (panel.style.display === "none" || panel.style.display === "") {
          panel.style.display = "block";
          button.textContent = "âœï¸ å…³é—­ç¼–è¾‘";
          document.getElementById("editDate").value = formatDate(currentDate);
        } else {
          panel.style.display = "none";
          button.textContent = "âœï¸ ç¼–è¾‘è¯¾ç¨‹å®‰æ’";
        }
      }

      function handleCourseSelect() {
        const select = document.getElementById("courseSelect");
        const customGroup = document.getElementById("customCourseGroup");
        const customInput = document.getElementById("customCourseName");

        if (select.value === "custom") {
          customGroup.style.display = "block";
          customInput.focus();
        } else {
          customGroup.style.display = "none";
          customInput.value = "";
        }

        const categorySelect = document.getElementById("courseCategory");
        if (
          select.value.includes("è‹±è¯­") ||
          select.value.includes("å²›ä¸»") ||
          select.value.includes("åˆ·é¢˜")
        ) {
          categorySelect.value = "å­¦ç§‘è¾…å¯¼";
        }
      }

      function getCourseName() {
        const courseSelect = document.getElementById("courseSelect");
        const customCourseName = document.getElementById("customCourseName");

        if (courseSelect.value === "custom") {
          return customCourseName.value.trim();
        } else {
          return courseSelect.value;
        }
      }

      function getCourseTypeFromName(courseName) {
        if (courseName.includes("è‹±è¯­SMK")) return "smk";
        if (courseName.includes("å²›ä¸»")) return "island";
        if (courseName.includes("æ™®è€å¸ˆ") || courseName.includes("åˆ·é¢˜"))
          return "teacher";
        if (courseName.includes("è‹±è¯­YH")) return "english";
        if (
          courseName.includes("æ¸¸æ³³") ||
          courseName.includes("è·‘æ­¥") ||
          courseName.includes("ç¯®çƒ") ||
          courseName.includes("è¿åŠ¨")
        )
          return "exercise";
        if (
          courseName.includes("ä½œä¸š") ||
          courseName.includes("èƒŒè¯µ") ||
          courseName.includes("ç»ƒä¹ ")
        )
          return "homework";
        if (
          courseName.includes("ç”»ç”»") ||
          courseName.includes("éŸ³ä¹") ||
          courseName.includes("é’¢ç´")
        )
          return "art";
        return "other";
      }

      function addCourse() {
        const date = document.getElementById("editDate").value;
        const startTime = document.getElementById("startTime").value;
        const endTime = document.getElementById("endTime").value;
        const courseName = getCourseName();
        const courseCategory = document.getElementById("courseCategory").value;

        if (!date || !startTime || !endTime || !courseName) {
          showMessage("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯ï¼", "error");
          return;
        }

        if (startTime >= endTime) {
          showMessage("ç»“æŸæ—¶é—´å¿…é¡»æ™šäºå¼€å§‹æ—¶é—´ï¼", "error");
          return;
        }

        const timeStr = `${startTime}-${endTime}`;
        const courseType = getCourseTypeFromName(courseName);

        const newCourse = {
          time: timeStr,
          course: courseName,
          type: courseType,
          category: courseCategory,
        };

        if (!scheduleData[date]) {
          scheduleData[date] = [];
        }

        scheduleData[date].push(newCourse);

        scheduleData[date].sort((a, b) => {
          const timeA = a.time.split("-")[0];
          const timeB = b.time.split("-")[0];
          return timeA.localeCompare(timeB);
        });

        showMessage(`æˆåŠŸæ·»åŠ è¯¾ç¨‹ï¼š${courseName}`, "success");
        clearForm();

        if (date === formatDate(currentDate)) {
          updateDisplay();
        }

        viewDateCourses();
      }

      function viewDateCourses() {
        const date = document.getElementById("editDate").value;
        if (!date) {
          showMessage("è¯·å…ˆé€‰æ‹©æ—¥æœŸï¼", "error");
          return;
        }

        const courses = scheduleData[date] || [];
        const courseList = document.getElementById("courseList");

        if (courses.length === 0) {
          courseList.innerHTML =
            '<p style="text-align: center; color: #666;">è¿™ä¸€å¤©è¿˜æ²¡æœ‰å®‰æ’è¯¾ç¨‹</p>';
          return;
        }

        courseList.innerHTML = `
                <h4 style="margin-bottom: 15px;">ğŸ“… ${date} çš„è¯¾ç¨‹å®‰æ’ï¼š</h4>
                ${courses
                  .map(
                    (course, index) => `
                    <div class="course-list-item">
                        <div class="course-info">
                            <strong>${course.time}</strong> - ${course.course}
                            <br><small style="color: #666;">${course.category}</small>
                        </div>
                        <div class="course-actions">
                            <button class="btn btn-danger btn-small" onclick="deleteCourse('${date}', ${index})">åˆ é™¤</button>
                        </div>
                    </div>
                `
                  )
                  .join("")}
            `;
      }

      function deleteCourse(date, index) {
        if (confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè¯¾ç¨‹å—ï¼Ÿ")) {
          scheduleData[date].splice(index, 1);

          if (scheduleData[date].length === 0) {
            scheduleData[date] = [];
          }

          showMessage("è¯¾ç¨‹å·²åˆ é™¤", "success");
          viewDateCourses();

          if (date === formatDate(currentDate)) {
            updateDisplay();
          }
        }
      }

      function clearForm() {
        document.getElementById("startTime").value = "";
        document.getElementById("endTime").value = "";
        document.getElementById("courseSelect").value = "";
        document.getElementById("customCourseName").value = "";
        document.getElementById("customCourseGroup").style.display = "none";
        document.getElementById("courseCategory").value = "å­¦ç§‘è¾…å¯¼";
      }

      function clearAllCourses() {
        const date = document.getElementById("editDate").value;
        if (!date) {
          showMessage("è¯·å…ˆé€‰æ‹©æ—¥æœŸï¼", "error");
          return;
        }

        if (confirm(`ç¡®å®šè¦æ¸…ç©º ${date} çš„æ‰€æœ‰è¯¾ç¨‹å—ï¼Ÿ`)) {
          scheduleData[date] = [];
          showMessage("å·²æ¸…ç©ºå½“å¤©æ‰€æœ‰è¯¾ç¨‹", "success");
          viewDateCourses();

          if (date === formatDate(currentDate)) {
            updateDisplay();
          }
        }
      }

      function showMessage(text, type) {
        const successMsg = document.getElementById("successMessage");
        const errorMsg = document.getElementById("errorMessage");

        successMsg.style.display = "none";
        errorMsg.style.display = "none";

        if (type === "success") {
          successMsg.textContent = text;
          successMsg.style.display = "block";
          setTimeout(() => (successMsg.style.display = "none"), 3000);
        } else {
          errorMsg.textContent = text;
          errorMsg.style.display = "block";
          setTimeout(() => (errorMsg.style.display = "none"), 3000);
        }
      }

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
        updateDisplay();
        bindEvents();
        
        // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡å³å°†å¼€å§‹çš„è¯¾ç¨‹
        setInterval(checkUpcomingCourses, 60000);

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener("keydown", (e) => {
          if (e.key === "ArrowLeft") changeDate(-1);
          if (e.key === "ArrowRight") changeDate(1);
          if (e.key === "Home") {
            currentDate = new Date();
            updateDisplay();
          }
        });
      });
    </script>
  </body>
</html>
